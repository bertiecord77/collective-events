<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Venue | COLLECTIVE.</title>
  <meta name="description" content="Discover this COLLECTIVE. venue partner - hosting creative, digital and tech events across the East Midlands.">
  <meta name="robots" content="index, follow">

  <!-- Open Graph / Facebook - Updated dynamically via JavaScript -->
  <meta property="og:type" content="place">
  <meta property="og:title" content="Venue | COLLECTIVE.">
  <meta property="og:description" content="Discover this COLLECTIVE. venue partner - hosting creative, digital and tech events.">
  <meta property="og:image" content="https://storage.googleapis.com/msgsndr/JcB0t2fZpGS0lMrqKDWQ/media/68a869c41614bd2d4f9e6688.png">
  <meta property="og:site_name" content="COLLECTIVE.">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Venue | COLLECTIVE.">
  <meta name="twitter:description" content="Discover this COLLECTIVE. venue partner.">
  <meta name="twitter:image" content="https://storage.googleapis.com/msgsndr/JcB0t2fZpGS0lMrqKDWQ/media/68a869c41614bd2d4f9e6688.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://storage.googleapis.com/msgsndr/JcB0t2fZpGS0lMrqKDWQ/media/68a869c41614bd2d4f9e6688.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/main.css">
  <style>
    /* Venue Page Styles */
    .venue-hero {
      position: relative;
      min-height: 60vh;
      display: flex;
      align-items: flex-end;
      padding: var(--space-8) var(--space-4);
      overflow: hidden;
    }

    .venue-hero-bg {
      position: absolute;
      inset: 0;
      z-index: 0;
    }

    .venue-hero-bg img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .venue-hero-bg::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.3) 50%, transparent 100%);
    }

    .venue-hero-content {
      position: relative;
      z-index: 1;
      max-width: 900px;
      width: 100%;
      margin: 0 auto;
    }

    .venue-breadcrumb {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      margin-bottom: var(--space-3);
      font-size: var(--text-sm);
      color: var(--text-muted);
    }

    .venue-breadcrumb a {
      color: var(--text-muted);
      text-decoration: none;
    }

    .venue-breadcrumb a:hover {
      color: var(--lime);
    }

    .venue-hero h1 {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 700;
      margin-bottom: var(--space-2);
      line-height: 1.1;
    }

    .venue-hero-location {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-size: var(--text-lg);
      color: var(--text-muted);
    }

    .venue-hero-location svg {
      width: 20px;
      height: 20px;
      color: var(--lime);
    }

    /* Content Grid */
    .venue-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--space-8) var(--space-4);
      display: grid;
      grid-template-columns: 1fr 380px;
      gap: var(--space-8);
    }

    @media (max-width: 900px) {
      .venue-content {
        grid-template-columns: 1fr;
      }
    }

    /* Main Content */
    .venue-main h2 {
      font-size: var(--text-2xl);
      margin-bottom: var(--space-4);
    }

    .venue-description {
      font-size: var(--text-lg);
      line-height: 1.8;
      color: var(--text-secondary);
      margin-bottom: var(--space-6);
    }

    .venue-description p {
      margin-bottom: var(--space-4);
    }

    /* Info Cards */
    .venue-info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-4);
      margin-bottom: var(--space-8);
    }

    @media (max-width: 600px) {
      .venue-info-grid {
        grid-template-columns: 1fr;
      }
    }

    .venue-info-card {
      background: var(--surface);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
    }

    .venue-info-card h3 {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-size: var(--text-base);
      font-weight: 600;
      margin-bottom: var(--space-2);
    }

    .venue-info-card h3 svg {
      width: 20px;
      height: 20px;
      color: var(--lime);
    }

    .venue-info-card p {
      font-size: var(--text-sm);
      color: var(--text-muted);
      line-height: 1.6;
    }

    /* Sidebar */
    .venue-sidebar {
      display: flex;
      flex-direction: column;
      gap: var(--space-5);
    }

    .sidebar-card {
      background: var(--surface);
      border-radius: var(--radius-lg);
      padding: var(--space-5);
    }

    .sidebar-card h3 {
      font-size: var(--text-lg);
      margin-bottom: var(--space-4);
    }

    /* Quick Links */
    .quick-links {
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    .quick-link {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      padding: var(--space-3);
      background: var(--background);
      border-radius: var(--radius-md);
      text-decoration: none;
      color: var(--text-primary);
      transition: all var(--transition-fast);
    }

    .quick-link:hover {
      background: var(--lime);
      color: var(--background);
    }

    .quick-link svg {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
    }

    .quick-link span {
      font-size: var(--text-sm);
      font-weight: 500;
    }

    /* Map Embed */
    .venue-map {
      width: 100%;
      aspect-ratio: 4/3;
      border-radius: var(--radius-lg);
      overflow: hidden;
      background: var(--surface);
    }

    .venue-map iframe {
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* Events at Venue */
    .venue-events {
      padding: var(--space-8) var(--space-4);
      background: var(--surface);
    }

    .venue-events-header {
      max-width: 1200px;
      margin: 0 auto var(--space-6);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: var(--space-4);
    }

    .venue-events-header h2 {
      font-size: var(--text-2xl);
      margin: 0;
    }

    .events-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: var(--space-5);
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Other Venues */
    .other-venues {
      padding: var(--space-8) var(--space-4);
    }

    .other-venues-header {
      text-align: center;
      margin-bottom: var(--space-6);
    }

    .other-venues-header h2 {
      font-size: var(--text-2xl);
      margin-bottom: var(--space-2);
    }

    .other-venues-header p {
      color: var(--text-muted);
    }

    .venues-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: var(--space-5);
      max-width: 1200px;
      margin: 0 auto;
    }

    .venue-card {
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      aspect-ratio: 16/10;
      text-decoration: none;
      color: inherit;
    }

    .venue-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform var(--transition-base);
    }

    .venue-card:hover img {
      transform: scale(1.05);
    }

    .venue-card-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.2) 60%, transparent 100%);
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: var(--space-4);
    }

    .venue-card h3 {
      font-size: var(--text-lg);
      font-weight: 600;
      margin-bottom: var(--space-1);
    }

    .venue-card p {
      font-size: var(--text-sm);
      color: var(--text-muted);
    }

    /* Loading & Empty States */
    .loading-spinner {
      display: flex;
      justify-content: center;
      padding: var(--space-8);
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--lime);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .empty-state {
      text-align: center;
      padding: var(--space-8);
      color: var(--text-muted);
      grid-column: 1 / -1;
    }

    .empty-state h3 {
      font-size: var(--text-xl);
      margin-bottom: var(--space-2);
      color: var(--text-primary);
    }

    /* 404 State */
    .venue-not-found {
      min-height: 60vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: var(--space-8) var(--space-4);
    }

    .venue-not-found h1 {
      font-size: var(--text-4xl);
      margin-bottom: var(--space-4);
    }

    .venue-not-found p {
      font-size: var(--text-lg);
      color: var(--text-muted);
      margin-bottom: var(--space-6);
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="nav">
    <div class="nav-container">
      <a href="/" class="nav-logo">
        <img src="https://storage.googleapis.com/msgsndr/JcB0t2fZpGS0lMrqKDWQ/media/68a869c41614bd2d4f9e6688.png" alt="COLLECTIVE." height="40">
      </a>
      <div class="nav-links">
        <a href="/" class="nav-link">Events</a>
        <a href="/speakers" class="nav-link">Speakers</a>
        <a href="/about" class="nav-link">About</a>
      </div>
    </div>
  </nav>

  <main id="main-content">
    <div class="loading-spinner" id="loading">
      <div class="spinner"></div>
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-brand">
        <img src="https://storage.googleapis.com/msgsndr/JcB0t2fZpGS0lMrqKDWQ/media/68a869c41614bd2d4f9e6688.png" alt="COLLECTIVE." class="footer-logo">
        <p>Building connections across the East Midlands creative, digital and tech community.</p>
      </div>
      <div class="footer-links">
        <h4>Events</h4>
        <ul>
          <li><a href="/">Upcoming</a></li>
          <li><a href="/past">Past Events</a></li>
          <li><a href="/speakers">Speakers</a></li>
        </ul>
      </div>
      <div class="footer-links">
        <h4>Locations</h4>
        <ul>
          <li><a href="/nottingham">Nottingham</a></li>
          <li><a href="/mansfield">Mansfield</a></li>
          <li><a href="/chesterfield">Chesterfield</a></li>
          <li><a href="/derby">Derby</a></li>
        </ul>
      </div>
      <div class="footer-links">
        <h4>Connect</h4>
        <ul>
          <li><a href="/about">About Us</a></li>
          <li><a href="mailto:hello@cdicollective.co.uk">Contact</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <div>
        <span style="color: var(--text-muted);">Proudly built in Notts by <a href="https://notluck.co.uk" target="_blank">NotLuck</a></span>
        <span style="margin-left: 1rem;">&copy; 2026 COLLECTIVE.</span>
      </div>
      <div class="social-links">
        <a href="https://linkedin.com/company/cdicollective" target="_blank" aria-label="LinkedIn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
        </a>
        <a href="https://instagram.com/cdicollective" target="_blank" aria-label="Instagram">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
        </a>
      </div>
    </div>
  </footer>

  <script src="/assets/js/api.js?v=2"></script>
  <script>
    const { fetchEvents, fetchVenues, fetchVenue, getEventImage, formatDate, isUpcoming } = window.CollectiveAPI;

    // Icons as SVG strings
    const ICONS = {
      location: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>',
      map: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon><line x1="8" y1="2" x2="8" y2="18"></line><line x1="16" y1="6" x2="16" y2="22"></line></svg>',
      parking: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><path d="M9 17V7h4a3 3 0 0 1 0 6H9"></path></svg>',
      bus: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 6v6"></path><path d="M16 6v6"></path><path d="M2 12h20"></path><path d="M4 17v-5a9 9 0 0 1 18 0v5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z"></path><circle cx="7" cy="17" r="2"></circle><circle cx="17" cy="17" r="2"></circle></svg>',
      accessible: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="4" r="2"></circle><path d="M12 6v6"></path><path d="M8 12h8"></path><path d="M12 12v6"></path><circle cx="9" cy="19" r="2"></circle><circle cx="15" cy="19" r="2"></circle></svg>',
      directions: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg>',
      what3words: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>',
      external: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>'
    };

    // Fallback venue data (same as API fallbacks, for client-side use)
    const VENUE_FALLBACKS = {
      'nottingham-trent-university': {
        slug: 'nottingham-trent-university',
        name: 'Nottingham Trent University',
        address: '50 Shakespeare Street, Nottingham NG1 4FQ',
        city: 'Nottingham',
        postcode: 'NG1 4FQ',
        mapsUrl: 'https://maps.google.com/?q=50+Shakespeare+Street+Nottingham+NG1+4FQ',
        what3words: null,
        parking: 'No visitor parking on campus. Use park & ride or city centre car parks. On-street parking on Dryden Street. Avoid Goldsmith/Shakespeare Streets (restricted).',
        transport: 'Nottingham Trent University tram stop outside. 15 min walk from train station.',
        accessibility: 'Comprehensive access across campus. AccessAble guide available for building.',
        description: 'Nottingham Trent University is a leading modern university in the heart of Nottingham. Their city campus hosts COLLECTIVE. events in state-of-the-art facilities, perfectly positioned for the creative and digital community.',
        image: 'https://images.unsplash.com/photo-1562774053-701939374585?w=1200&auto=format&fit=crop'
      },
      'mansfield-palace-theatre': {
        slug: 'mansfield-palace-theatre',
        name: 'Mansfield Palace Theatre',
        address: 'Leeming Street, Mansfield NG18 1NG',
        city: 'Mansfield',
        postcode: 'NG18 1NG',
        mapsUrl: 'https://maps.google.com/?q=Mansfield+Palace+Theatre+Leeming+Street+NG18+1NG',
        what3words: null,
        parking: 'No on-site parking. Toothill Road car park (NG18 1NW): Â£1/hr, FREE disabled parking.',
        transport: '10 min walk from Mansfield station. Bus stops outside on Leeming Street.',
        accessibility: 'Wheelchair access via Box Office entrance. Lift to balcony. Hearing loops fitted. Call 01623 633133 to book wheelchair spaces.',
        description: 'The Mansfield Palace Theatre is a stunning Edwardian venue that has been entertaining audiences since 1910. Now a proud COLLECTIVE. venue partner, it brings creative and business events to North Nottinghamshire in a truly unique setting.',
        image: 'https://lh3.googleusercontent.com/gps-cs-s/AG0ilSzvlBOw88SHxNALLPlsUaf-Qcn6lKsChmKtnzs5YXX3CCAHA-yrMGG5y8oRqmF-sGV1-9i2K2j_PBqFf0Z09PTRaxZAYjKaN9tay1CMF-xmWZSgDumlGLFJAsxDnH1yQtOk1p8e8g=w800'
      },
      'the-batch-house': {
        slug: 'the-batch-house',
        name: 'The Batch House',
        address: 'The Glass Yard, Sheffield Road, Chesterfield S41 8JY',
        city: 'Chesterfield',
        postcode: 'S41 8JY',
        mapsUrl: 'https://maps.google.com/?q=The+Batch+House+Glass+Yard+Chesterfield+S41+8JY',
        what3words: null,
        parking: 'FREE parking at The Glass Yard (163 spaces). Opposite the football stadium.',
        transport: 'Multiple bus routes stop outside on Sheffield Road.',
        accessibility: 'Step-free access, lift to first floor. Pushchair friendly.',
        description: 'The Batch House is a vibrant independent venue at The Glass Yard in Chesterfield. Known for great coffee, food, and community events, it\'s the perfect space for COLLECTIVE. to connect Derbyshire\'s creative professionals.',
        image: 'https://images.unsplash.com/photo-1559329007-40df8a9345d8?w=1200&auto=format&fit=crop'
      }
    };

    function getVenueSlug() {
      const path = window.location.pathname;
      const match = path.match(/^\/venue\/([^\/]+)/);
      return match ? match[1] : null;
    }

    function generateMapEmbedUrl(address) {
      if (!address) return null;
      return `https://www.google.com/maps/embed/v1/place?key=AIzaSyBFw0Qbyq9zTFTd-tUY6CE-j-gVFgWFXRw&q=${encodeURIComponent(address)}`;
    }

    function renderVenue(venue, events) {
      const upcomingEvents = events.filter(e => isUpcoming(e.date));
      const pastEvents = events.filter(e => !isUpcoming(e.date)).slice(0, 3);

      // Update page meta
      document.title = `${venue.name} | COLLECTIVE. Venue`;
      document.querySelector('meta[name="description"]').content =
        `${venue.name} - COLLECTIVE. venue partner in ${venue.city}. ${venue.description?.substring(0, 150) || ''}`;

      const main = document.getElementById('main-content');
      main.innerHTML = `
        <!-- Hero -->
        <section class="venue-hero">
          <div class="venue-hero-bg">
            <img src="${venue.image || 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=1200&auto=format&fit=crop'}" alt="${venue.name}">
          </div>
          <div class="venue-hero-content">
            <div class="venue-breadcrumb">
              <a href="/">Home</a>
              <span>/</span>
              <a href="/${venue.city?.toLowerCase() || ''}">Venues</a>
              <span>/</span>
              <span>${venue.name}</span>
            </div>
            <span class="badge badge-lime">Venue Partner</span>
            <h1>${venue.name}</h1>
            <div class="venue-hero-location">
              ${ICONS.location}
              <span>${venue.city || ''}</span>
            </div>
          </div>
        </section>

        <!-- Content -->
        <div class="venue-content">
          <div class="venue-main">
            <h2>About This Venue</h2>
            <div class="venue-description">
              <p>${venue.description || `${venue.name} is a proud COLLECTIVE. venue partner, hosting events for the East Midlands creative and digital community.`}</p>
            </div>

            <div class="venue-info-grid">
              ${venue.parking ? `
                <div class="venue-info-card">
                  <h3>${ICONS.parking} Parking</h3>
                  <p>${venue.parking}</p>
                </div>
              ` : ''}
              ${venue.transport ? `
                <div class="venue-info-card">
                  <h3>${ICONS.bus} Public Transport</h3>
                  <p>${venue.transport}</p>
                </div>
              ` : ''}
              ${venue.accessibility ? `
                <div class="venue-info-card">
                  <h3>${ICONS.accessible} Accessibility</h3>
                  <p>${venue.accessibility}</p>
                </div>
              ` : ''}
              ${venue.what3words ? `
                <div class="venue-info-card">
                  <h3>${ICONS.what3words} what3words</h3>
                  <p>///${venue.what3words.replace('///', '')}</p>
                </div>
              ` : ''}
            </div>
          </div>

          <aside class="venue-sidebar">
            <div class="sidebar-card">
              <h3>Quick Links</h3>
              <div class="quick-links">
                ${venue.mapsUrl ? `
                  <a href="${venue.mapsUrl}" target="_blank" rel="noopener" class="quick-link">
                    ${ICONS.directions}
                    <span>Get Directions</span>
                  </a>
                ` : ''}
                ${venue.what3words ? `
                  <a href="https://what3words.com/${venue.what3words.replace('///', '')}" target="_blank" rel="noopener" class="quick-link">
                    ${ICONS.what3words}
                    <span>Open in what3words</span>
                  </a>
                ` : ''}
                ${venue.website ? `
                  <a href="${venue.website}" target="_blank" rel="noopener" class="quick-link">
                    ${ICONS.external}
                    <span>Venue Website</span>
                  </a>
                ` : ''}
              </div>
            </div>

            <div class="sidebar-card">
              <h3>Address</h3>
              <p style="color: var(--text-muted); line-height: 1.6;">
                ${venue.address || ''}<br>
                ${venue.postcode || ''}
              </p>
            </div>

            ${venue.address ? `
              <div class="venue-map">
                <iframe
                  src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBFw0Qbyq9zTFTd-tUY6CEbj-gVFgWFXRw&q=${encodeURIComponent(venue.address)}"
                  allowfullscreen
                  loading="lazy"
                  referrerpolicy="no-referrer-when-downgrade"
                ></iframe>
              </div>
            ` : ''}
          </aside>
        </div>

        <!-- Upcoming Events -->
        ${upcomingEvents.length > 0 ? `
          <section class="venue-events">
            <div class="venue-events-header">
              <h2>Upcoming Events at ${venue.name}</h2>
              <a href="/${venue.city?.toLowerCase() || ''}" class="btn btn-secondary">View All Events</a>
            </div>
            <div class="events-grid">
              ${upcomingEvents.map(event => `
                <a href="/event/${event.slug || event.id}" class="card card-hover">
                  <div class="card-image">
                    <img src="${getEventImage(event)}" alt="${event.title}" loading="lazy">
                    <span class="badge badge-lime" style="position: absolute; top: 12px; left: 12px;">Upcoming</span>
                  </div>
                  <div class="card-content">
                    <div class="card-meta">${formatDate(event.date)}</div>
                    <h3 class="card-title">${event.title}</h3>
                    <p class="card-description">${event.shortDescription || ''}</p>
                  </div>
                </a>
              `).join('')}
            </div>
          </section>
        ` : ''}

        <!-- Other Venues -->
        <section class="other-venues">
          <div class="other-venues-header">
            <h2>Other Venue Partners</h2>
            <p>Discover more COLLECTIVE. venues across the East Midlands</p>
          </div>
          <div class="venues-grid" id="other-venues"></div>
        </section>
      `;

      // Render other venues
      renderOtherVenues(venue.slug);
    }

    function renderOtherVenues(currentSlug) {
      const container = document.getElementById('other-venues');
      const otherVenues = Object.values(VENUE_FALLBACKS).filter(v => v.slug !== currentSlug);

      container.innerHTML = otherVenues.map(v => `
        <a href="/venue/${v.slug}" class="venue-card">
          <img src="${v.image || 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=600&auto=format&fit=crop'}" alt="${v.name}" loading="lazy">
          <div class="venue-card-overlay">
            <h3>${v.name}</h3>
            <p>${v.city}</p>
          </div>
        </a>
      `).join('');
    }

    function renderNotFound() {
      document.title = 'Venue Not Found | COLLECTIVE.';
      const main = document.getElementById('main-content');
      main.innerHTML = `
        <div class="venue-not-found">
          <h1>Venue Not Found</h1>
          <p>We couldn't find that venue. It may have been removed or the URL might be incorrect.</p>
          <a href="/" class="btn btn-primary">Browse Events</a>
        </div>
      `;
    }

    async function init() {
      const slug = getVenueSlug();

      if (!slug) {
        renderNotFound();
        return;
      }

      try {
        // Try to get venue from API first, fall back to local data
        let venue = null;

        // Check local fallbacks first (faster)
        if (VENUE_FALLBACKS[slug]) {
          venue = VENUE_FALLBACKS[slug];
        }

        // Try API if available
        if (typeof fetchVenue === 'function') {
          try {
            const apiVenue = await fetchVenue(slug);
            if (apiVenue) {
              venue = apiVenue;
            }
          } catch (e) {
            console.log('API venue fetch failed, using fallback');
          }
        }

        if (!venue) {
          renderNotFound();
          return;
        }

        // Fetch events at this venue
        const eventsData = await fetchEvents({ limit: 100 });
        const allEvents = eventsData.events || [];

        // Filter events by venue (match by name or city)
        const venueEvents = allEvents.filter(e => {
          const eventVenue = e.venue?.name?.toLowerCase() || '';
          const eventCity = e.locationTag?.toLowerCase() || '';
          return eventVenue.includes(venue.name.toLowerCase()) ||
                 eventCity === venue.city?.toLowerCase();
        });

        renderVenue(venue, venueEvents);

      } catch (error) {
        console.error('Error loading venue:', error);
        renderNotFound();
      }
    }

    init();
  </script>
</body>
</html>
